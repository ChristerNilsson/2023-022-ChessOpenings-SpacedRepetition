// Generated by CoffeeScript 2.5.1
var SIZE,
  modulo = function(a, b) { return (+a % (b = +b) + b) % b; },
  indexOf = [].indexOf;

import _ from 'https://cdn.skypack.dev/lodash';

import {
  ass,
  lerp,
  param,
  range,
  hexToBase64
} from '../js/utils.js';

import cryptoJs from 'https://cdn.skypack.dev/crypto-js';

import {
  Square
} from '../js/square.js';

import {
  Button
} from '../js/button.js';

import {
  coords,
  clickString,
  global,
  loadTree,
  toObjectNotation,
  toUCI
} from '../js/globals.js';

import {
  dumpState
} from '../js/globals.js';

SIZE = global.SIZE;

export var Board = (function() {
  var calcBar;

  class Board {
    constructor() {
      var i, k, len, ref, x0, x1, x2, x3;
      this.click = this.click.bind(this);
      // g√• igenom nodens barn och visa dem
      this.showChildren = this.showChildren.bind(this);
      this.draw = this.draw.bind(this);
      this.littera = this.littera.bind(this);
      this.flip = this.flip.bind(this);
      this.squares = [];
      this.clickedSquares = [];
      this.pieces = "";
      this.flipped = false;
      ref = range(64);
      for (k = 0, len = ref.length; k < len; k++) {
        i = ref[k];
        ((i) => {
          return this.squares.push(new Square(i, () => {
            return this.click(i);
          }));
        })(i);
      }
      this.buttons = [];
      x0 = 1.5;
      x1 = 3.5;
      x2 = 5.5;
      x3 = 7.5;
      this.buttons.push(new Button(x0 * SIZE, 9.5 * SIZE, 'undo', () => {
        return clickString('undo');
      }));
      this.buttons.push(new Button(x1 * SIZE, 9.5 * SIZE, 'flip', () => {
        return clickString('flip');
      }));
      this.buttons.push(new Button(x2 * SIZE, 9.5 * SIZE, 'link', () => {
        return clickString('link');
      }));
      this.buttons.push(new Button(x3 * SIZE, 9.5 * SIZE, 'save', () => {
        return clickString('save');
      }));
    }

    click(i) {
      var col, color, move, row, sq, uci;
      col = modulo(i, 8);
      row = 7 - Math.floor(i / 8);
      sq = global.chess.board()[row][col];
      color = "wb"[modulo(global.chess.history().length, 2)];
      if (this.clickedSquares.length === 0) {
        if (sq !== null && sq.color === color) {
          return this.clickedSquares.push(i);
        }
      } else {
        if (i === this.clickedSquares[0]) {
          return this.clickedSquares = [];
        } else {
          this.clickedSquares.push(i);
          move = toObjectNotation(this.clickedSquares);
          uci = toUCI(this.clickedSquares);
          if (global.chess.move(move)) { // accepera draget
            global.stack.push(global.currNode);
            // console.log uci,global.currNode
            if (!(uci in global.currNode)) {
              global.currNode[uci] = {};
              global.count++;
            }
            global.currNode = global.currNode[uci];
          }
          return this.clickedSquares = [];
        }
      }
    }

    showChildren() {
      var i, k, len, ref, san, uci, value;
      push();
      noStroke();
      textAlign(LEFT, CENTER);
      ref = range(global.children.length);
      for (k = 0, len = ref.length; k < len; k++) {
        i = ref[k];
        [value, san, uci] = global.children[i];
        if (global.child === i) {
          fill('yellow');
        } else {
          fill('black');
        }
        text(san + ": " + value, 8.7 * SIZE, 1 * SIZE + i * 0.5 * SIZE);
      }
      return pop();
    }

    draw() {
      var button, i, j, k, l, len, len1, len2, m, n, piece, ref, ref1, ref2, score;
      this.buttons[3].text = global.count > 0 ? 'save ' + global.count : "";
      ref = this.buttons;
      for (k = 0, len = ref.length; k < len; k++) {
        button = ref[k];
        button.draw();
      }
      if (!global.tree) {
        return;
      }
      fill('white');
      textSize(SIZE * 0.3);
      push();
      textAlign(LEFT, CENTER);
      text(global.name, 0.05 * SIZE, 0.3 * SIZE);
      pop();
      ref1 = range(8);
      for (l = 0, len1 = ref1.length; l < len1; l++) {
        i = ref1[l];
        ref2 = range(8);
        for (m = 0, len2 = ref2.length; m < len2; m++) {
          j = ref2[m];
          piece = global.chess.board()[7 - i][j];
          this.squares[i * 8 + j].draw(piece, this.flipped, i * 8 + j === this.clickedSquares[0]);
        }
      }
      stroke('black');
      noFill();
      rect(SIZE * 4.5, SIZE * 4.5, SIZE * 8, SIZE * 8);
      this.littera();
      push();
      textAlign(CENTER, CENTER);
      text(global.version, 7.5 * SIZE, 10 * SIZE);
      //textAlign RIGHT,CENTER
      textSize(20);
      n = global.stack.length;
      if (n === 0) {
        score = '0';
      }
      if (n % 2 === 0) {
        fill('white');
      } else {
        fill('black');
      }
      text(1 + Math.floor(n / 2), 9.4 * SIZE, 0.3 * SIZE);
      pop();
      //@drawBars score
      return this.showChildren();
    }

    littera() {
      var digits, i, k, len, letters, ref, results;
      noStroke();
      fill('black');
      textSize(SIZE * 0.3);
      letters = this.flipped ? "hgfedcba" : "abcdefgh";
      digits = this.flipped ? "12345678" : "87654321";
      ref = range(8);
      results = [];
      for (k = 0, len = ref.length; k < len; k++) {
        i = ref[k];
        text(letters[i], SIZE * (i + 1), SIZE * 8.8);
        results.push(text(digits[i], SIZE * 0.15, SIZE * (i + 1)));
      }
      return results;
    }

    flip() {
      return this.flipped = !this.flipped;
    }

    drawBars(score) {
      var h, w, x;
      param.String(score);
      stroke('black');
      h = calcBar(score);
      push();
      if (this.flipped) {
        translate(0, SIZE * 9);
        scale(1, -1);
      }
      rectMode(CORNER);
      noStroke();
      x = 0.35 * SIZE;
      w = 0.10 * SIZE;
      fill('black');
      rect(x, 0.5 * SIZE, w, SIZE * 4);
      fill('white');
      rect(x, 4.5 * SIZE, w, SIZE * 4);
      if (h > 0) {
        fill('white');
        rect(x, 4.5 * SIZE - h, w, h);
      } else {
        fill('black');
        rect(x, 4.5 * SIZE, w, -h);
      }
      return pop();
    }

  };

  calcBar = (score) => {
    var LIMIT, d, res;
    return "0";
    param.String(score);
    LIMIT = 2000;
    if (score[0] === '#') {
      d = LIMIT;
    } else {
      d = Math.abs(score);
    }
    if (d > LIMIT) {
      d = LIMIT;
    }
    res = lerp(0, 4 * SIZE, d / LIMIT);
    if (indexOf.call(score, "-") >= 0) {
      res = -res;
    }
    return param.Integer(Math.round(res));
  };

  ass(4 * SIZE, calcBar("2100"));

  ass(4 * SIZE, calcBar("2000"));

  ass(2 * SIZE, calcBar("1000"));

  ass(SIZE, calcBar("500"));

  ass(0, calcBar("1"));

  ass(-SIZE, calcBar("-500"));

  ass(-4 * SIZE, calcBar("#-1"));

  return Board;

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYm9hcmQuanMiLCJzb3VyY2VSb290IjoiLi4iLCJzb3VyY2VzIjpbImNvZmZlZVxcYm9hcmQuY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxJQUFBLElBQUE7RUFBQTs7O0FBQUEsT0FBTyxDQUFQLE1BQUE7O0FBQ0EsT0FBQTtFQUFRLEdBQVI7RUFBWSxJQUFaO0VBQWlCLEtBQWpCO0VBQXVCLEtBQXZCO0VBQTZCLFdBQTdCO0NBQUEsTUFBQTs7QUFDQSxPQUFPLFFBQVAsTUFBQTs7QUFDQSxPQUFBO0VBQVEsTUFBUjtDQUFBLE1BQUE7O0FBQ0EsT0FBQTtFQUFRLE1BQVI7Q0FBQSxNQUFBOztBQUNBLE9BQUE7RUFBUSxNQUFSO0VBQWUsV0FBZjtFQUEyQixNQUEzQjtFQUFrQyxRQUFsQztFQUEyQyxnQkFBM0M7RUFBNEQsS0FBNUQ7Q0FBQSxNQUFBOztBQUNBLE9BQUE7RUFBUSxTQUFSO0NBQUEsTUFBQTs7QUFFQSxJQUFBLEdBQU8sTUFBTSxDQUFDOztBQUVkLE9BQUEsSUFBYTs7O0VBQU4sTUFBQSxNQUFBO0lBQ04sV0FBYSxDQUFBLENBQUE7QUFDZCxVQUFBLENBQUEsRUFBQSxDQUFBLEVBQUEsR0FBQSxFQUFBLEdBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQTtVQWlCQyxDQUFBLFlBQUEsQ0FBQSxpQkFqQkQ7O1VBMENDLENBQUEsbUJBQUEsQ0FBQTtVQVVBLENBQUEsV0FBQSxDQUFBO1VBNENBLENBQUEsY0FBQSxDQUFBO1VBV0EsQ0FBQSxXQUFBLENBQUE7TUEzR0MsSUFBQyxDQUFBLE9BQUQsR0FBVztNQUNYLElBQUMsQ0FBQSxjQUFELEdBQWtCO01BQ2xCLElBQUMsQ0FBQSxNQUFELEdBQVU7TUFDVixJQUFDLENBQUEsT0FBRCxHQUFXO0FBQ1g7TUFBQSxLQUFBLHFDQUFBOztRQUNJLENBQUEsQ0FBQyxDQUFELENBQUEsR0FBQTtpQkFBTyxJQUFDLENBQUEsT0FBTyxDQUFDLElBQVQsQ0FBYyxJQUFJLE1B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Q0FBQSxHQUFFLEtBQUw7TUFBZ0IsQ0FBQSxHQUFJLE1BQXBCOztJQUNBLEdBQUEsR0FBTSxJQUFBLENBQUssQ0FBTCxFQUFRLENBQUEsR0FBRSxJQUFWLEVBQWdCLENBQUEsR0FBRSxLQUFsQjtJQUNOLGlCQUFVLE9BQVAsU0FBSDtNQUFxQixHQUFBLEdBQU0sQ0FBQyxJQUE1Qjs7V0FDQSxLQUFLLENBQUMsT0FBTixDQUFjLElBQUksQ0FBQyxLQUFMLENBQVcsR0FBWCxDQUFkO0VBVlM7O0VBV1YsR0FBQSxDQUFJLENBQUEsR0FBRSxJQUFOLEVBQVcsT0FBQSxDQUFRLE1BQVIsQ0FBWDs7RUFDQSxHQUFBLENBQUksQ0FBQSxHQUFFLElBQU4sRUFBVyxPQUFBLENBQVEsTUFBUixDQUFYOztFQUNBLEdBQUEsQ0FBSSxDQUFBLEdBQUUsSUFBTixFQUFXLE9BQUEsQ0FBUSxNQUFSLENBQVg7O0VBQ0EsR0FBQSxDQUFJLElBQUosRUFBUyxPQUFBLENBQVEsS0FBUixDQUFUOztFQUNBLEdBQUEsQ0FBSSxDQUFKLEVBQU0sT0FBQSxDQUFRLEdBQVIsQ0FBTjs7RUFDQSxHQUFBLENBQUksQ0FBQyxJQUFMLEVBQVUsT0FBQSxDQUFRLE1BQVIsQ0FBVjs7RUFDQSxHQUFBLENBQUksQ0FBQyxDQUFELEdBQUcsSUFBUCxFQUFZLE9BQUEsQ0FBUSxLQUFSLENBQVoiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgXyBmcm9tICdodHRwczovL2Nkbi5za3lwYWNrLmRldi9sb2Rhc2gnXHJcbmltcG9ydCB7YXNzLGxlcnAscGFyYW0scmFuZ2UsaGV4VG9CYXNlNjR9IGZyb20gJy4uL2pzL3V0aWxzLmpzJ1xyXG5pbXBvcnQgY3J5cHRvSnMgZnJvbSAnaHR0cHM6Ly9jZG4uc2t5cGFjay5kZXYvY3J5cHRvLWpzJ1xyXG5pbXBvcnQge1NxdWFyZX0gZnJvbSAnLi4vanMvc3F1YXJlLmpzJ1xyXG5pbXBvcnQge0J1dHRvbn0gZnJvbSAnLi4vanMvYnV0dG9uLmpzJ1xyXG5pbXBvcnQge2Nvb3JkcyxjbGlja1N0cmluZyxnbG9iYWwsbG9hZFRyZWUsdG9PYmplY3ROb3RhdGlvbix0b1VDSX0gZnJvbSAnLi4vanMvZ2xvYmFscy5qcydcclxuaW1wb3J0IHtkdW1wU3RhdGV9IGZyb20gJy4uL2pzL2dsb2JhbHMuanMnXHJcblxyXG5TSVpFID0gZ2xvYmFsLlNJWkVcclxuXHJcbmV4cG9ydCBjbGFzcyBCb2FyZFxyXG5cdGNvbnN0cnVjdG9yOiAtPlxyXG5cdFx0QHNxdWFyZXMgPSBbXVxyXG5cdFx0QGNsaWNrZWRTcXVhcmVzID0gW11cclxuXHRcdEBwaWVjZXMgPSBcIlwiXHJcblx0XHRAZmxpcHBlZCA9IGZhbHNlXHJcblx0XHRmb3IgaSBpbiByYW5nZSA2NFxyXG5cdFx0XHRkbyAoaSkgPT4gQHNxdWFyZXMucHVzaCBuZXcgU3F1YXJlIGksID0+IEBjbGljayBpXHJcblxyXG5cdFx0QGJ1dHRvbnMgPSBbXVxyXG5cdFx0eDAgPSAxLjVcclxuXHRcdHgxID0gMy41XHJcblx0XHR4MiA9IDUuNVxyXG5cdFx0eDMgPSA3LjVcclxuXHRcdEBidXR0b25zLnB1c2ggbmV3IEJ1dHRvbiB4MCpTSVpFLCA5LjUqU0laRSwgJ3VuZG8nLCA9PiBjbGlja1N0cmluZyAndW5kbydcclxuXHRcdEBidXR0b25zLnB1c2ggbmV3IEJ1dHRvbiB4MSpTSVpFLCA5LjUqU0laRSwgJ2ZsaXAnLCA9PiBjbGlja1N0cmluZyAnZmxpcCdcclxuXHRcdEBidXR0b25zLnB1c2ggbmV3IEJ1dHRvbiB4MipTSVpFLCA5LjUqU0laRSwgJ2xpbmsnLCA9PiBjbGlja1N0cmluZyAnbGluaydcclxuXHRcdEBidXR0b25zLnB1c2ggbmV3IEJ1dHRvbiB4MypTSVpFLCA5LjUqU0laRSwgJ3NhdmUnLCA9PiBjbGlja1N0cmluZyAnc2F2ZSdcclxuXHJcblx0Y2xpY2sgOiAoaSkgPT5cclxuXHRcdGNvbCA9IGkgJSUgOFxyXG5cdFx0cm93ID0gNy1pIC8vIDhcclxuXHRcdHNxID0gZ2xvYmFsLmNoZXNzLmJvYXJkKClbcm93XVtjb2xdXHJcblx0XHRjb2xvciA9IFwid2JcIltnbG9iYWwuY2hlc3MuaGlzdG9yeSgpLmxlbmd0aCAlJSAyXSAjIGbDtnJ2w6RudGFkIGbDpHJnIHDDpSBwasOkc2VuXHJcblxyXG5cdFx0aWYgQGNsaWNrZWRTcXVhcmVzLmxlbmd0aCA9PSAwXHJcblx0XHRcdGlmIHNxICE9IG51bGwgYW5kIHNxLmNvbG9yID09IGNvbG9yIHRoZW4gQGNsaWNrZWRTcXVhcmVzLnB1c2ggaVxyXG5cdFx0ZWxzZVxyXG5cdFx0XHRpZiBpID09IEBjbGlja2VkU3F1YXJlc1swXVxyXG5cdFx0XHRcdEBjbGlja2VkU3F1YXJlcyA9IFtdXHJcblx0XHRcdGVsc2VcclxuXHRcdFx0XHRAY2xpY2tlZFNxdWFyZXMucHVzaCBpXHJcblx0XHRcdFx0bW92ZSA9IHRvT2JqZWN0Tm90YXRpb24gQGNsaWNrZWRTcXVhcmVzXHJcblx0XHRcdFx0dWNpID0gdG9VQ0kgQGNsaWNrZWRTcXVhcmVzXHJcblx0XHRcdFx0aWYgZ2xvYmFsLmNoZXNzLm1vdmUgbW92ZSAjIGFjY2VwZXJhIGRyYWdldFxyXG5cdFx0XHRcdFx0Z2xvYmFsLnN0YWNrLnB1c2ggZ2xvYmFsLmN1cnJOb2RlXHJcblx0XHRcdFx0XHQjIGNvbnNvbGUubG9nIHVjaSxnbG9iYWwuY3Vyck5vZGVcclxuXHRcdFx0XHRcdGlmIHVjaSBub3Qgb2YgZ2xvYmFsLmN1cnJOb2RlXHJcblx0XHRcdFx0XHRcdGdsb2JhbC5jdXJyTm9kZVt1Y2ldID0ge31cclxuXHRcdFx0XHRcdFx0Z2xvYmFsLmNvdW50KytcclxuXHRcdFx0XHRcdGdsb2JhbC5jdXJyTm9kZSA9IGdsb2JhbC5jdXJyTm9kZVt1Y2ldXHJcblx0XHRcdFx0QGNsaWNrZWRTcXVhcmVzID0gW11cclxuXHJcbiMgZ8OlIGlnZW5vbSBub2RlbnMgYmFybiBvY2ggdmlzYSBkZW1cclxuXHRzaG93Q2hpbGRyZW4gOiA9PlxyXG5cdFx0cHVzaCgpXHJcblx0XHRub1N0cm9rZSgpXHJcblx0XHR0ZXh0QWxpZ24gTEVGVCxDRU5URVJcclxuXHRcdGZvciBpIGluIHJhbmdlIGdsb2JhbC5jaGlsZHJlbi5sZW5ndGhcclxuXHRcdFx0W3ZhbHVlLHNhbix1Y2ldID0gZ2xvYmFsLmNoaWxkcmVuW2ldXHJcblx0XHRcdGlmIGdsb2JhbC5jaGlsZCA9PSBpIHRoZW4gZmlsbCAneWVsbG93JyBlbHNlIGZpbGwgJ2JsYWNrJ1xyXG5cdFx0XHR0ZXh0IHNhbisgXCI6IFwiICsgdmFsdWUsIDguNypTSVpFLCAxKlNJWkUgKyBpKjAuNSpTSVpFXHJcblx0XHRwb3AoKVxyXG5cclxuXHRkcmF3IDogPT5cclxuXHJcblx0XHRAYnV0dG9uc1szXS50ZXh0ID0gaWYgZ2xvYmFsLmNvdW50PjAgdGhlbiAnc2F2ZSAnICsgZ2xvYmFsLmNvdW50IGVsc2UgXCJcIlxyXG5cclxuXHRcdGZvciBidXR0b24gaW4gQGJ1dHRvbnNcclxuXHRcdFx0YnV0dG9uLmRyYXcoKVxyXG5cclxuXHRcdGlmIG5vdCBnbG9iYWwudHJlZSB0aGVuIHJldHVyblxyXG5cclxuXHRcdGZpbGwgJ3doaXRlJ1xyXG5cdFx0dGV4dFNpemUgU0laRSowLjNcclxuXHJcblx0XHRwdXNoKClcclxuXHRcdHRleHRBbGlnbiBMRUZULENFTlRFUlxyXG5cdFx0dGV4dCBnbG9iYWwubmFtZSwwLjA1KlNJWkUsIDAuMypTSVpFXHJcblx0XHRwb3AoKVxyXG5cclxuXHRcdGZvciBpIGluIHJhbmdlIDhcclxuXHRcdFx0Zm9yIGogaW4gcmFuZ2UgOFxyXG5cdFx0XHRcdHBpZWNlID0gZ2xvYmFsLmNoZXNzLmJvYXJkKClbNy1pXVtqXSAjIHtzcXVhcmUsIHR5cGUsIGNvbG9yfVxyXG5cdFx0XHRcdEBzcXVhcmVzW2kqOCtqXS5kcmF3IHBpZWNlLCBAZmxpcHBlZCwgaSo4K2o9PUBjbGlja2VkU3F1YXJlc1swXVxyXG5cclxuXHRcdHN0cm9rZSAnYmxhY2snXHJcblx0XHRub0ZpbGwoKVxyXG5cdFx0cmVjdCBTSVpFKjQuNSxTSVpFKjQuNSxTSVpFKjgsU0laRSo4XHJcblxyXG5cdFx0QGxpdHRlcmEoKVxyXG5cclxuXHRcdHB1c2goKVxyXG5cdFx0dGV4dEFsaWduIENFTlRFUixDRU5URVJcclxuXHJcblx0XHR0ZXh0IGdsb2JhbC52ZXJzaW9uLCA3LjUqU0laRSwgMTAqU0laRVxyXG5cdFx0I3RleHRBbGlnbiBSSUdIVCxDRU5URVJcclxuXHJcblx0XHR0ZXh0U2l6ZSAyMFxyXG5cdFx0biA9IGdsb2JhbC5zdGFjay5sZW5ndGhcclxuXHRcdGlmIG4gPT0gMCB0aGVuIHNjb3JlID0gJzAnXHJcblx0XHRpZiBuJTIgPT0gMCB0aGVuIGZpbGwgJ3doaXRlJyBlbHNlIGZpbGwgJ2JsYWNrJ1xyXG5cdFx0dGV4dCAxK24vLzIsIDkuNCpTSVpFLCAwLjMqU0laRVxyXG5cclxuXHRcdHBvcCgpXHJcblx0XHQjQGRyYXdCYXJzIHNjb3JlXHJcblx0XHRAc2hvd0NoaWxkcmVuKClcclxuXHJcblx0bGl0dGVyYSA6ID0+XHJcblx0XHRub1N0cm9rZSgpXHJcblx0XHRmaWxsICdibGFjaydcclxuXHRcdHRleHRTaXplIFNJWkUqMC4zXHJcblx0XHRsZXR0ZXJzID0gaWYgQGZsaXBwZWQgdGhlbiBcImhnZmVkY2JhXCIgZWxzZSBcImFiY2RlZmdoXCJcclxuXHRcdGRpZ2l0cyA9IGlmIEBmbGlwcGVkIHRoZW4gIFwiMTIzNDU2NzhcIiBlbHNlIFwiODc2NTQzMjFcIlxyXG5cclxuXHRcdGZvciBpIGluIHJhbmdlIDhcclxuXHRcdFx0dGV4dCBsZXR0ZXJzW2ldLFNJWkUqKGkrMSksU0laRSo4LjhcclxuXHRcdFx0dGV4dCBkaWdpdHNbaV0sU0laRSowLjE1LFNJWkUqKGkrMSlcclxuXHJcblx0ZmxpcCA6ID0+IEBmbGlwcGVkID0gbm90IEBmbGlwcGVkXHJcblxyXG5cdGRyYXdCYXJzIDogKHNjb3JlKSAtPlxyXG5cdFx0cGFyYW0uU3RyaW5nIHNjb3JlXHJcblx0XHRzdHJva2UgJ2JsYWNrJyBcclxuXHRcdGggPSBjYWxjQmFyIHNjb3JlXHJcblx0XHRwdXNoKClcclxuXHRcdGlmIEBmbGlwcGVkXHJcblx0XHRcdHRyYW5zbGF0ZSAwLCBTSVpFKjlcclxuXHRcdFx0c2NhbGUgMSwgLTFcclxuXHRcdHJlY3RNb2RlIENPUk5FUlxyXG5cdFx0bm9TdHJva2UoKVxyXG5cdFx0eCA9IDAuMzUgKiBTSVpFXHJcblx0XHR3ID0gMC4xMCAqIFNJWkVcclxuXHRcdGZpbGwgJ2JsYWNrJ1xyXG5cdFx0cmVjdCB4LCAwLjUqU0laRSwgdywgU0laRSAqIDRcclxuXHRcdGZpbGwgJ3doaXRlJ1xyXG5cdFx0cmVjdCB4LCA0LjUqU0laRSwgdywgU0laRSAqIDRcclxuXHRcdGlmIGggPiAwXHJcblx0XHRcdGZpbGwgJ3doaXRlJ1xyXG5cdFx0XHRyZWN0IHgsIDQuNSpTSVpFIC0gaCwgdywgaFxyXG5cdFx0ZWxzZVxyXG5cdFx0XHRmaWxsICdibGFjaydcclxuXHRcdFx0cmVjdCB4LCA0LjUqU0laRSwgdywgLWhcclxuXHRcdHBvcCgpXHJcblxyXG5cdGNhbGNCYXIgPSAoc2NvcmUpID0+XHJcblx0XHRyZXR1cm4gXCIwXCJcclxuXHJcblx0XHRwYXJhbS5TdHJpbmcgc2NvcmVcclxuXHRcdExJTUlUID0gMjAwMFxyXG5cdFx0aWYgc2NvcmVbMF09PScjJyB0aGVuIGQgPSBMSU1JVFxyXG5cdFx0ZWxzZSBkID0gTWF0aC5hYnMgc2NvcmVcclxuXHRcdGlmIGQ+TElNSVQgdGhlbiBkID0gTElNSVRcclxuXHRcdHJlcyA9IGxlcnAgMCwgNCpTSVpFLCBkL0xJTUlUXHJcblx0XHRpZiBcIi1cIiBpbiBzY29yZSB0aGVuIHJlcyA9IC1yZXNcclxuXHRcdHBhcmFtLkludGVnZXIgTWF0aC5yb3VuZCByZXNcclxuXHRhc3MgNCpTSVpFLGNhbGNCYXIgXCIyMTAwXCJcclxuXHRhc3MgNCpTSVpFLGNhbGNCYXIgXCIyMDAwXCJcclxuXHRhc3MgMipTSVpFLGNhbGNCYXIgXCIxMDAwXCJcclxuXHRhc3MgU0laRSxjYWxjQmFyIFwiNTAwXCJcclxuXHRhc3MgMCxjYWxjQmFyIFwiMVwiXHJcblx0YXNzIC1TSVpFLGNhbGNCYXIgXCItNTAwXCJcclxuXHRhc3MgLTQqU0laRSxjYWxjQmFyIFwiIy0xXCJcclxuIl19
//# sourceURL=c:\github\2023-019-ChessTree\coffee\board.coffee