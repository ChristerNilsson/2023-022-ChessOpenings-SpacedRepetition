// Generated by CoffeeScript 2.5.1
var SIZE,
  modulo = function(a, b) { return (+a % (b = +b) + b) % b; },
  indexOf = [].indexOf;

import _ from 'https://cdn.skypack.dev/lodash';

import {
  ass,
  lerp,
  param,
  range,
  hexToBase64
} from '../js/utils.js';

import cryptoJs from 'https://cdn.skypack.dev/crypto-js';

import {
  Square
} from '../js/square.js';

import {
  Button
} from '../js/button.js';

import {
  coords,
  clickString,
  global,
  loadTree,
  toObjectNotation,
  toUCI
} from '../js/globals.js';

import {
  dumpState
} from '../js/globals.js';

SIZE = global.SIZE;

export var Board = (function() {
  var calcBar;

  class Board {
    constructor() {
      var i, k, len, ref, x0, x1, x2, x3;
      this.click = this.click.bind(this);
      // g√• igenom nodens barn och visa dem
      this.showChildren = this.showChildren.bind(this);
      this.draw = this.draw.bind(this);
      this.littera = this.littera.bind(this);
      this.flip = this.flip.bind(this);
      this.squares = [];
      this.clickedSquares = [];
      this.pieces = "";
      this.flipped = false;
      ref = range(64);
      for (k = 0, len = ref.length; k < len; k++) {
        i = ref[k];
        ((i) => {
          return this.squares.push(new Square(i, () => {
            return this.click(i);
          }));
        })(i);
      }
      this.buttons = [];
      x0 = 1.5;
      x1 = 3.5;
      x2 = 5.5;
      x3 = 7.5;
      this.buttons.push(new Button(x0 * SIZE, 9.5 * SIZE, 'undo', () => {
        return clickString('undo');
      }));
      this.buttons.push(new Button(x1 * SIZE, 9.5 * SIZE, 'flip', () => {
        return clickString('flip');
      }));
      this.buttons.push(new Button(x2 * SIZE, 9.5 * SIZE, 'link', () => {
        return clickString('link');
      }));
      this.buttons.push(new Button(x3 * SIZE, 9.5 * SIZE, 'save', () => {
        return clickString('save');
      }));
    }

    click(i) {
      var col, color, move, row, sq, uci;
      col = modulo(i, 8);
      row = 7 - Math.floor(i / 8);
      sq = global.chess.board()[row][col];
      color = "wb"[modulo(global.chess.history().length, 2)];
      if (this.clickedSquares.length === 0) {
        if (sq !== null && sq.color === color) {
          return this.clickedSquares.push(i);
        }
      } else {
        if (i === this.clickedSquares[0]) {
          return this.clickedSquares = [];
        } else {
          this.clickedSquares.push(i);
          move = toObjectNotation(this.clickedSquares);
          uci = toUCI(this.clickedSquares);
          if (global.chess.move(move)) { // accepera draget
            global.stack.push(global.currNode);
            // console.log uci,global.currNode
            if (!(uci in global.currNode)) {
              global.currNode[uci] = {};
              global.count++;
            }
            global.currNode = global.currNode[uci];
          }
          return this.clickedSquares = [];
        }
      }
    }

    showChildren() {
      var i, k, len, ref, san, uci, value;
      push();
      noStroke();
      textAlign(LEFT, CENTER);
      ref = range(global.children.length);
      for (k = 0, len = ref.length; k < len; k++) {
        i = ref[k];
        [value, san, uci] = global.children[i];
        if (global.child === i) {
          fill('yellow');
        } else {
          fill('black');
        }
        text(san + ": " + value, 8.7 * SIZE, 1 * SIZE + i * 0.5 * SIZE);
      }
      return pop();
    }

    draw() {
      var button, i, j, k, l, len, len1, len2, m, n, piece, ref, ref1, ref2, score;
      this.buttons[3].text = global.count > 0 ? 'save ' + global.count : "";
      ref = this.buttons;
      for (k = 0, len = ref.length; k < len; k++) {
        button = ref[k];
        button.draw();
      }
      if (!global.tree) {
        return;
      }
      fill('white');
      textSize(SIZE * 0.3);
      push();
      textAlign(LEFT, CENTER);
      text(global.name, 0.05 * SIZE, 0.3 * SIZE);
      pop();
      ref1 = range(8);
      for (l = 0, len1 = ref1.length; l < len1; l++) {
        i = ref1[l];
        ref2 = range(8);
        for (m = 0, len2 = ref2.length; m < len2; m++) {
          j = ref2[m];
          piece = global.chess.board()[7 - i][j];
          this.squares[i * 8 + j].draw(piece, this.flipped, i * 8 + j === this.clickedSquares[0]);
        }
      }
      stroke('black');
      noFill();
      rect(SIZE * 4.5, SIZE * 4.5, SIZE * 8, SIZE * 8);
      this.littera();
      push();
      textAlign(CENTER, CENTER);
      text(global.version, 7.5 * SIZE, 10 * SIZE);
      //textAlign RIGHT,CENTER
      textSize(20);
      n = global.stack.length;
      if (n === 0) {
        score = '0';
      }
      if (n % 2 === 0) {
        fill('white');
      } else {
        fill('black');
      }
      text(1 + Math.floor(n / 2), 9.4 * SIZE, 0.3 * SIZE);
      pop();
      //@drawBars score
      return this.showChildren();
    }

    littera() {
      var digits, i, k, len, letters, ref, results;
      noStroke();
      fill('black');
      textSize(SIZE * 0.3);
      letters = this.flipped ? "hgfedcba" : "abcdefgh";
      digits = this.flipped ? "12345678" : "87654321";
      ref = range(8);
      results = [];
      for (k = 0, len = ref.length; k < len; k++) {
        i = ref[k];
        text(letters[i], SIZE * (i + 1), SIZE * 8.8);
        results.push(text(digits[i], SIZE * 0.15, SIZE * (i + 1)));
      }
      return results;
    }

    flip() {
      return this.flipped = !this.flipped;
    }

    drawBars(score) {
      var h, w, x;
      param.String(score);
      stroke('black');
      h = calcBar(score);
      push();
      if (this.flipped) {
        translate(0, SIZE * 9);
        scale(1, -1);
      }
      rectMode(CORNER);
      noStroke();
      x = 0.35 * SIZE;
      w = 0.10 * SIZE;
      fill('black');
      rect(x, 0.5 * SIZE, w, SIZE * 4);
      fill('white');
      rect(x, 4.5 * SIZE, w, SIZE * 4);
      if (h > 0) {
        fill('white');
        rect(x, 4.5 * SIZE - h, w, h);
      } else {
        fill('black');
        rect(x, 4.5 * SIZE, w, -h);
      }
      return pop();
    }

  };

  calcBar = (score) => {
    var LIMIT, d, res;
    return "0";
    param.String(score);
    LIMIT = 2000;
    if (score[0] === '#') {
      d = LIMIT;
    } else {
      d = Math.abs(score);
    }
    if (d > LIMIT) {
      d = LIMIT;
    }
    res = lerp(0, 4 * SIZE, d / LIMIT);
    if (indexOf.call(score, "-") >= 0) {
      res = -res;
    }
    return param.Integer(Math.round(res));
  };

  return Board;

}).call(this);

// ass 4*SIZE,calcBar "2100"
// ass 4*SIZE,calcBar "2000"
// ass 2*SIZE,calcBar "1000"
// ass SIZE,calcBar "500"
// ass 0,calcBar "1"
// ass -SIZE,calcBar "-500"
// ass -4*SIZE,calcBar "#-1"

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYm9hcmQuanMiLCJzb3VyY2VSb290IjoiLi4iLCJzb3VyY2VzIjpbImNvZmZlZVxcYm9hcmQuY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxJQUFBLElBQUE7RUFBQTs7O0FBQUEsT0FBTyxDQUFQLE1BQUE7O0FBQ0EsT0FBQTtFQUFRLEdBQVI7RUFBWSxJQUFaO0VBQWlCLEtBQWpCO0VBQXVCLEtBQXZCO0VBQTZCLFdBQTdCO0NBQUEsTUFBQTs7QUFDQSxPQUFPLFFBQVAsTUFBQTs7QUFDQSxPQUFBO0VBQVEsTUFBUjtDQUFBLE1BQUE7O0FBQ0EsT0FBQTtFQUFRLE1BQVI7Q0FBQSxNQUFBOztBQUNBLE9BQUE7RUFBUSxNQUFSO0VBQWUsV0FBZjtFQUEyQixNQUEzQjtFQUFrQyxRQUFsQztFQUEyQyxnQkFBM0M7RUFBNEQsS0FBNUQ7Q0FBQSxNQUFBOztBQUNBLE9BQUE7RUFBUSxTQUFSO0NBQUEsTUFBQTs7QUFFQSxJQUFBLEdBQU8sTUFBTSxDQUFDOztBQUVkLE9BQUEsSUFBYTs7O0VBQU4sTUFBQSxNQUFBO0lBQ04sV0FBYSxDQUFBLENBQUE7QUFDZCxVQUFBLENBQUEsRUFBQSxDQUFBLEVBQUEsR0FBQSxFQUFBLEdBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQTtVQWlCQyxDQUFBLFlBQUEsQ0FBQSxpQkFqQkQ7O1VBMENDLENBQUEsbUJBQUEsQ0FBQTtVQVVBLENBQUEsV0FBQSxDQUFBO1VBNENBLENBQUEsY0FBQSxDQUFBO1VBV0EsQ0FBQSxXQUFBLENBQUE7TUEzR0MsSUFBQyxDQUFBLE9BQUQsR0FBVztNQUNYLElBQUMsQ0FBQSxjQUFELEdBQWtCO01BQ2xCLElBQUMsQ0FBQSxNQUFELEdBQVU7TUFDVixJQUFDLENBQUEsT0FBRCxHQUFXO0FBQ1g7TUFBQSxLQUFBLHFDQUFBOztRQUNJLENBQUEsQ0FBQyxDQUFELENBQUEsR0FBQTtpQkFBTyxJQUFDLENBQUEsT0FBTyxDQUFDLElBQVQsQ0FBYyxJQUFJLE1B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Q0FBQSxHQUFFLEtBQUw7TUFBZ0IsQ0FBQSxHQUFJLE1BQXBCOztJQUNBLEdBQUEsR0FBTSxJQUFBLENBQUssQ0FBTCxFQUFRLENBQUEsR0FBRSxJQUFWLEVBQWdCLENBQUEsR0FBRSxLQUFsQjtJQUNOLGlCQUFVLE9BQVAsU0FBSDtNQUFxQixHQUFBLEdBQU0sQ0FBQyxJQUE1Qjs7V0FDQSxLQUFLLENBQUMsT0FBTixDQUFjLElBQUksQ0FBQyxLQUFMLENBQVcsR0FBWCxDQUFkO0VBVlM7Ozs7OztBQWpKWCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBfIGZyb20gJ2h0dHBzOi8vY2RuLnNreXBhY2suZGV2L2xvZGFzaCdcclxuaW1wb3J0IHthc3MsbGVycCxwYXJhbSxyYW5nZSxoZXhUb0Jhc2U2NH0gZnJvbSAnLi4vanMvdXRpbHMuanMnXHJcbmltcG9ydCBjcnlwdG9KcyBmcm9tICdodHRwczovL2Nkbi5za3lwYWNrLmRldi9jcnlwdG8tanMnXHJcbmltcG9ydCB7U3F1YXJlfSBmcm9tICcuLi9qcy9zcXVhcmUuanMnXHJcbmltcG9ydCB7QnV0dG9ufSBmcm9tICcuLi9qcy9idXR0b24uanMnXHJcbmltcG9ydCB7Y29vcmRzLGNsaWNrU3RyaW5nLGdsb2JhbCxsb2FkVHJlZSx0b09iamVjdE5vdGF0aW9uLHRvVUNJfSBmcm9tICcuLi9qcy9nbG9iYWxzLmpzJ1xyXG5pbXBvcnQge2R1bXBTdGF0ZX0gZnJvbSAnLi4vanMvZ2xvYmFscy5qcydcclxuXHJcblNJWkUgPSBnbG9iYWwuU0laRVxyXG5cclxuZXhwb3J0IGNsYXNzIEJvYXJkXHJcblx0Y29uc3RydWN0b3I6IC0+XHJcblx0XHRAc3F1YXJlcyA9IFtdXHJcblx0XHRAY2xpY2tlZFNxdWFyZXMgPSBbXVxyXG5cdFx0QHBpZWNlcyA9IFwiXCJcclxuXHRcdEBmbGlwcGVkID0gZmFsc2VcclxuXHRcdGZvciBpIGluIHJhbmdlIDY0XHJcblx0XHRcdGRvIChpKSA9PiBAc3F1YXJlcy5wdXNoIG5ldyBTcXVhcmUgaSwgPT4gQGNsaWNrIGlcclxuXHJcblx0XHRAYnV0dG9ucyA9IFtdXHJcblx0XHR4MCA9IDEuNVxyXG5cdFx0eDEgPSAzLjVcclxuXHRcdHgyID0gNS41XHJcblx0XHR4MyA9IDcuNVxyXG5cdFx0QGJ1dHRvbnMucHVzaCBuZXcgQnV0dG9uIHgwKlNJWkUsIDkuNSpTSVpFLCAndW5kbycsID0+IGNsaWNrU3RyaW5nICd1bmRvJ1xyXG5cdFx0QGJ1dHRvbnMucHVzaCBuZXcgQnV0dG9uIHgxKlNJWkUsIDkuNSpTSVpFLCAnZmxpcCcsID0+IGNsaWNrU3RyaW5nICdmbGlwJ1xyXG5cdFx0QGJ1dHRvbnMucHVzaCBuZXcgQnV0dG9uIHgyKlNJWkUsIDkuNSpTSVpFLCAnbGluaycsID0+IGNsaWNrU3RyaW5nICdsaW5rJ1xyXG5cdFx0QGJ1dHRvbnMucHVzaCBuZXcgQnV0dG9uIHgzKlNJWkUsIDkuNSpTSVpFLCAnc2F2ZScsID0+IGNsaWNrU3RyaW5nICdzYXZlJ1xyXG5cclxuXHRjbGljayA6IChpKSA9PlxyXG5cdFx0Y29sID0gaSAlJSA4XHJcblx0XHRyb3cgPSA3LWkgLy8gOFxyXG5cdFx0c3EgPSBnbG9iYWwuY2hlc3MuYm9hcmQoKVtyb3ddW2NvbF1cclxuXHRcdGNvbG9yID0gXCJ3YlwiW2dsb2JhbC5jaGVzcy5oaXN0b3J5KCkubGVuZ3RoICUlIDJdICMgZsO2cnbDpG50YWQgZsOkcmcgcMOlIHBqw6RzZW5cclxuXHJcblx0XHRpZiBAY2xpY2tlZFNxdWFyZXMubGVuZ3RoID09IDBcclxuXHRcdFx0aWYgc3EgIT0gbnVsbCBhbmQgc3EuY29sb3IgPT0gY29sb3IgdGhlbiBAY2xpY2tlZFNxdWFyZXMucHVzaCBpXHJcblx0XHRlbHNlXHJcblx0XHRcdGlmIGkgPT0gQGNsaWNrZWRTcXVhcmVzWzBdXHJcblx0XHRcdFx0QGNsaWNrZWRTcXVhcmVzID0gW11cclxuXHRcdFx0ZWxzZVxyXG5cdFx0XHRcdEBjbGlja2VkU3F1YXJlcy5wdXNoIGlcclxuXHRcdFx0XHRtb3ZlID0gdG9PYmplY3ROb3RhdGlvbiBAY2xpY2tlZFNxdWFyZXNcclxuXHRcdFx0XHR1Y2kgPSB0b1VDSSBAY2xpY2tlZFNxdWFyZXNcclxuXHRcdFx0XHRpZiBnbG9iYWwuY2hlc3MubW92ZSBtb3ZlICMgYWNjZXBlcmEgZHJhZ2V0XHJcblx0XHRcdFx0XHRnbG9iYWwuc3RhY2sucHVzaCBnbG9iYWwuY3Vyck5vZGVcclxuXHRcdFx0XHRcdCMgY29uc29sZS5sb2cgdWNpLGdsb2JhbC5jdXJyTm9kZVxyXG5cdFx0XHRcdFx0aWYgdWNpIG5vdCBvZiBnbG9iYWwuY3Vyck5vZGVcclxuXHRcdFx0XHRcdFx0Z2xvYmFsLmN1cnJOb2RlW3VjaV0gPSB7fVxyXG5cdFx0XHRcdFx0XHRnbG9iYWwuY291bnQrK1xyXG5cdFx0XHRcdFx0Z2xvYmFsLmN1cnJOb2RlID0gZ2xvYmFsLmN1cnJOb2RlW3VjaV1cclxuXHRcdFx0XHRAY2xpY2tlZFNxdWFyZXMgPSBbXVxyXG5cclxuIyBnw6UgaWdlbm9tIG5vZGVucyBiYXJuIG9jaCB2aXNhIGRlbVxyXG5cdHNob3dDaGlsZHJlbiA6ID0+XHJcblx0XHRwdXNoKClcclxuXHRcdG5vU3Ryb2tlKClcclxuXHRcdHRleHRBbGlnbiBMRUZULENFTlRFUlxyXG5cdFx0Zm9yIGkgaW4gcmFuZ2UgZ2xvYmFsLmNoaWxkcmVuLmxlbmd0aFxyXG5cdFx0XHRbdmFsdWUsc2FuLHVjaV0gPSBnbG9iYWwuY2hpbGRyZW5baV1cclxuXHRcdFx0aWYgZ2xvYmFsLmNoaWxkID09IGkgdGhlbiBmaWxsICd5ZWxsb3cnIGVsc2UgZmlsbCAnYmxhY2snXHJcblx0XHRcdHRleHQgc2FuKyBcIjogXCIgKyB2YWx1ZSwgOC43KlNJWkUsIDEqU0laRSArIGkqMC41KlNJWkVcclxuXHRcdHBvcCgpXHJcblxyXG5cdGRyYXcgOiA9PlxyXG5cclxuXHRcdEBidXR0b25zWzNdLnRleHQgPSBpZiBnbG9iYWwuY291bnQ+MCB0aGVuICdzYXZlICcgKyBnbG9iYWwuY291bnQgZWxzZSBcIlwiXHJcblxyXG5cdFx0Zm9yIGJ1dHRvbiBpbiBAYnV0dG9uc1xyXG5cdFx0XHRidXR0b24uZHJhdygpXHJcblxyXG5cdFx0aWYgbm90IGdsb2JhbC50cmVlIHRoZW4gcmV0dXJuXHJcblxyXG5cdFx0ZmlsbCAnd2hpdGUnXHJcblx0XHR0ZXh0U2l6ZSBTSVpFKjAuM1xyXG5cclxuXHRcdHB1c2goKVxyXG5cdFx0dGV4dEFsaWduIExFRlQsQ0VOVEVSXHJcblx0XHR0ZXh0IGdsb2JhbC5uYW1lLDAuMDUqU0laRSwgMC4zKlNJWkVcclxuXHRcdHBvcCgpXHJcblxyXG5cdFx0Zm9yIGkgaW4gcmFuZ2UgOFxyXG5cdFx0XHRmb3IgaiBpbiByYW5nZSA4XHJcblx0XHRcdFx0cGllY2UgPSBnbG9iYWwuY2hlc3MuYm9hcmQoKVs3LWldW2pdICMge3NxdWFyZSwgdHlwZSwgY29sb3J9XHJcblx0XHRcdFx0QHNxdWFyZXNbaSo4K2pdLmRyYXcgcGllY2UsIEBmbGlwcGVkLCBpKjgraj09QGNsaWNrZWRTcXVhcmVzWzBdXHJcblxyXG5cdFx0c3Ryb2tlICdibGFjaydcclxuXHRcdG5vRmlsbCgpXHJcblx0XHRyZWN0IFNJWkUqNC41LFNJWkUqNC41LFNJWkUqOCxTSVpFKjhcclxuXHJcblx0XHRAbGl0dGVyYSgpXHJcblxyXG5cdFx0cHVzaCgpXHJcblx0XHR0ZXh0QWxpZ24gQ0VOVEVSLENFTlRFUlxyXG5cclxuXHRcdHRleHQgZ2xvYmFsLnZlcnNpb24sIDcuNSpTSVpFLCAxMCpTSVpFXHJcblx0XHQjdGV4dEFsaWduIFJJR0hULENFTlRFUlxyXG5cclxuXHRcdHRleHRTaXplIDIwXHJcblx0XHRuID0gZ2xvYmFsLnN0YWNrLmxlbmd0aFxyXG5cdFx0aWYgbiA9PSAwIHRoZW4gc2NvcmUgPSAnMCdcclxuXHRcdGlmIG4lMiA9PSAwIHRoZW4gZmlsbCAnd2hpdGUnIGVsc2UgZmlsbCAnYmxhY2snXHJcblx0XHR0ZXh0IDErbi8vMiwgOS40KlNJWkUsIDAuMypTSVpFXHJcblxyXG5cdFx0cG9wKClcclxuXHRcdCNAZHJhd0JhcnMgc2NvcmVcclxuXHRcdEBzaG93Q2hpbGRyZW4oKVxyXG5cclxuXHRsaXR0ZXJhIDogPT5cclxuXHRcdG5vU3Ryb2tlKClcclxuXHRcdGZpbGwgJ2JsYWNrJ1xyXG5cdFx0dGV4dFNpemUgU0laRSowLjNcclxuXHRcdGxldHRlcnMgPSBpZiBAZmxpcHBlZCB0aGVuIFwiaGdmZWRjYmFcIiBlbHNlIFwiYWJjZGVmZ2hcIlxyXG5cdFx0ZGlnaXRzID0gaWYgQGZsaXBwZWQgdGhlbiAgXCIxMjM0NTY3OFwiIGVsc2UgXCI4NzY1NDMyMVwiXHJcblxyXG5cdFx0Zm9yIGkgaW4gcmFuZ2UgOFxyXG5cdFx0XHR0ZXh0IGxldHRlcnNbaV0sU0laRSooaSsxKSxTSVpFKjguOFxyXG5cdFx0XHR0ZXh0IGRpZ2l0c1tpXSxTSVpFKjAuMTUsU0laRSooaSsxKVxyXG5cclxuXHRmbGlwIDogPT4gQGZsaXBwZWQgPSBub3QgQGZsaXBwZWRcclxuXHJcblx0ZHJhd0JhcnMgOiAoc2NvcmUpIC0+XHJcblx0XHRwYXJhbS5TdHJpbmcgc2NvcmVcclxuXHRcdHN0cm9rZSAnYmxhY2snIFxyXG5cdFx0aCA9IGNhbGNCYXIgc2NvcmVcclxuXHRcdHB1c2goKVxyXG5cdFx0aWYgQGZsaXBwZWRcclxuXHRcdFx0dHJhbnNsYXRlIDAsIFNJWkUqOVxyXG5cdFx0XHRzY2FsZSAxLCAtMVxyXG5cdFx0cmVjdE1vZGUgQ09STkVSXHJcblx0XHRub1N0cm9rZSgpXHJcblx0XHR4ID0gMC4zNSAqIFNJWkVcclxuXHRcdHcgPSAwLjEwICogU0laRVxyXG5cdFx0ZmlsbCAnYmxhY2snXHJcblx0XHRyZWN0IHgsIDAuNSpTSVpFLCB3LCBTSVpFICogNFxyXG5cdFx0ZmlsbCAnd2hpdGUnXHJcblx0XHRyZWN0IHgsIDQuNSpTSVpFLCB3LCBTSVpFICogNFxyXG5cdFx0aWYgaCA+IDBcclxuXHRcdFx0ZmlsbCAnd2hpdGUnXHJcblx0XHRcdHJlY3QgeCwgNC41KlNJWkUgLSBoLCB3LCBoXHJcblx0XHRlbHNlXHJcblx0XHRcdGZpbGwgJ2JsYWNrJ1xyXG5cdFx0XHRyZWN0IHgsIDQuNSpTSVpFLCB3LCAtaFxyXG5cdFx0cG9wKClcclxuXHJcblx0Y2FsY0JhciA9IChzY29yZSkgPT5cclxuXHRcdHJldHVybiBcIjBcIlxyXG5cclxuXHRcdHBhcmFtLlN0cmluZyBzY29yZVxyXG5cdFx0TElNSVQgPSAyMDAwXHJcblx0XHRpZiBzY29yZVswXT09JyMnIHRoZW4gZCA9IExJTUlUXHJcblx0XHRlbHNlIGQgPSBNYXRoLmFicyBzY29yZVxyXG5cdFx0aWYgZD5MSU1JVCB0aGVuIGQgPSBMSU1JVFxyXG5cdFx0cmVzID0gbGVycCAwLCA0KlNJWkUsIGQvTElNSVRcclxuXHRcdGlmIFwiLVwiIGluIHNjb3JlIHRoZW4gcmVzID0gLXJlc1xyXG5cdFx0cGFyYW0uSW50ZWdlciBNYXRoLnJvdW5kIHJlc1xyXG5cdCMgYXNzIDQqU0laRSxjYWxjQmFyIFwiMjEwMFwiXHJcblx0IyBhc3MgNCpTSVpFLGNhbGNCYXIgXCIyMDAwXCJcclxuXHQjIGFzcyAyKlNJWkUsY2FsY0JhciBcIjEwMDBcIlxyXG5cdCMgYXNzIFNJWkUsY2FsY0JhciBcIjUwMFwiXHJcblx0IyBhc3MgMCxjYWxjQmFyIFwiMVwiXHJcblx0IyBhc3MgLVNJWkUsY2FsY0JhciBcIi01MDBcIlxyXG5cdCMgYXNzIC00KlNJWkUsY2FsY0JhciBcIiMtMVwiXHJcbiJdfQ==
//# sourceURL=c:\github\2023-022-ChessOpenings-SpacedRepetition\coffee\board.coffee