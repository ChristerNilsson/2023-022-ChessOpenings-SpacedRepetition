// Generated by CoffeeScript 2.5.1
var f, g, link, sortera, undo,
  modulo = function(a, b) { return (+a % (b = +b) + b) % b; },
  indexOf = [].indexOf;

import {
  ass,
  log,
  range,
  split,
  param,
  hexToBase64,
  spaceShip
} from '../js/utils.js';

import {
  Button
} from '../js/button.js';

import _ from 'https://cdn.skypack.dev/lodash';

import cryptoJs from 'https://cdn.skypack.dev/crypto-js';

import {
  download
} from '../js/download.js';

// export readArr = (filename) => global.arr = (loadJSON filename).arr
export var global = {
  //name : 'bishop',
  name: 'tree',
  arr: [],
  version: 'ver: B',
  board: null,
  child: 0, // move under consideration
  children: [], // sorted list of [value,san,uci]
  SIZE: 50, // of square
  pics: {}, // 12 pjäser
  data: null,
  buttons: [],
  database: {}, // fen => value
  currTree: 0, // index till träden
  currNode: null, // pekar in i ett träd
  count: 0, // räknar antal nya drag i trädet
  stack: [] // innehåller aktuell gren
};

export var coords = (uci) => {
  var c0, c1, r0, r1;
  param.String(uci);
  c0 = "abcdefgh".indexOf(uci[0]);
  r0 = "12345678".indexOf(uci[1]);
  c1 = "abcdefgh".indexOf(uci[2]);
  r1 = "12345678".indexOf(uci[3]);
  return param.Array([c0 + 8 * r0, c1 + 8 * r1]);
};

ass([8, 24], coords("a2a4"));

export var toUCI = ([from, to]) => {
  var c0, c1, r0, r1;
  param.Integer(from);
  param.Integer(to);
  c0 = "abcdefgh"[from % 8];
  r0 = "12345678"[Math.floor(from / 8)];
  c1 = "abcdefgh"[to % 8];
  r1 = "12345678"[Math.floor(to / 8)];
  return param.String(c0 + r0 + c1 + r1);
};

ass("e2e4", toUCI([12, 28]));

export var toObjectNotation = ([from, to]) => {
  var uci;
  param.Integer(from);
  param.Integer(to);
  uci = toUCI([from, to]);
  from = uci.slice(0, 2);
  to = uci.slice(2, 4);
  return param.Object({from, to});
};

ass({
  from: 'e2',
  to: 'e4'
}, toObjectNotation([12, 28]));

export var empty = (n) => {
  param.Integer(n);
  return param.String((1 + Math.floor(n / 8)).toString());
};

undo = () => {
  if (global.stack.length === 0) {
    return;
  }
  global.chess.undo();
  global.currNode = global.stack.pop();
  return makeChildren();
};

export var dumpState = () => {
  console.log('STATE ########');
  console.log('  stack', global.stack);
  console.log('  currNode', global.currNode);
  return console.log('  history', global.chess.history());
};

export var makeChildren = () => {
  var base64, fen, i, j, key, keys, len, pair, ref, san, value;
  console.log('makeChildren');
  keys = _.keys(global.currNode);
  global.children = [];
  ref = range(keys.length);
  for (j = 0, len = ref.length; j < len; j++) {
    i = ref[j];
    key = keys[i];
    pair = coords(key);
    global.chess.move(toObjectNotation(pair));
    fen = global.chess.fen();
    san = _.last(global.chess.history());
    base64 = hexToBase64(cryptoJs.SHA256(fen).toString()).slice(0, 8);
    value = global.database[base64] === null ? "?99" : global.database[base64];
    global.children.push([value, san, key]);
    console.log(key, san, base64, value, fen);
    global.chess.undo();
  }
  global.children = sortera(global.children);
  if (modulo(global.stack.length, 2) === 0) {
    global.children.reverse();
  }
  global.child = 0;
  return console.log('children', global.children);
};

sortera = (arr) => { // Hanterar ej mattar av olika längd. 
  // #1 och #2 ersätts båda med 9999
  // #-1 och #-2 ersätts båda med -9999
  // Bör: #1 > #2
  // Är: #1 == #2
  param.Array(arr);
  arr = _.map(arr, ([a, b, c]) => {
    if (typeof a === 'number') {
      return [a, b, c];
    }
    if (indexOf.call(a, '-') >= 0) {
      return [-9999, b, c];
    } else {
      return [9999, b, c];
    }
  });
  return arr.sort((a, b) => {
    return spaceShip(a[0], b[0]);
  });
};

ass([[2, "Nf3", "g1f3"], [11, "e4", "e2e4"]], sortera([[11, "e4", "e2e4"], [2, "Nf3", "g1f3"]]));

ass([[-9999, "Nf3", "g1f3"], [9999, "e4", "e2e4"]], sortera([["#1", "e4", "e2e4"], ["#-2", "Nf3", "g1f3"]]));

ass([[-9999, "Nf3", "g1f3"], [11, "e4", "e2e4"]], sortera([[11, "e4", "e2e4"], ["#-2", "Nf3", "g1f3"]]));

export var loadTree = (delta) => {
  param.Test(delta === (-1) || delta === 0 || delta === 1);
  global.currTree = modulo(global.currTree + delta, _.size(global.trees));
  global.currNode = global.tree; //.moves[""]
  global.stack = [];
  return makeChildren();
};

g = (item) => {
  // param.Integer item or param.String
  if (indexOf.call(item, "#-") >= 0) {
    return -1000;
  }
  if (indexOf.call(item, "#") >= 0) {
    return 1000;
  }
  return param.Integer(parseInt(item));
};

f = (arrScore, c) => {
  var a, b, d;
  param.Array(arrScore);
  param.String(c);
  arrScore = _.map(arrScore, (item) => {
    return g(item);
  });
  a = _.min(arrScore);
  b = _.max(arrScore);
  c = g(c);
  d = _.max([Math.abs(a), Math.abs(b)]);
  a = -d;
  return param.Number((c - a) / (2 * d));
};

ass(0, f([-100, 50], '-100'));

ass(0.75, f([-100, 50], '50'));

ass(1, f([-100, 50], '100'));

link = () => {
  return 'https://lichess.org/analysis/' + global.chess.fen();
};

export var clickString = (key) => {
  var san, uci, value;
  param.String(key);
  if (key === 'flip') {
    return global.board.flip();
  } else if (key === 'link') {
    return window.open(link(), '_blank');
  } else if (key === 'up') {
    return global.child = modulo(global.child - 1, global.children.length);
  } else if (key === 'down') {
    return global.child = modulo(global.child + 1, global.children.length);
  } else if (key === 'undo') {
    return undo();
  } else if (key === 'left') {
    return undo();
  } else if (key === 'right') {
    console.log(global.children, global.child);
    [value, san, uci] = global.children[global.child];
    console.log('move', [value, san, uci]);
    global.chess.move(san);
    global.stack.push(global.currNode);
    global.currNode = global.currNode[uci];
    return makeChildren();
  } else if (key === 'save') {
    return download(global.tree, global.name + '.json');
  } else {
    return console.log('unknown key in clickString', key);
  }
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2xvYmFscy5qcyIsInNvdXJjZVJvb3QiOiIuLiIsInNvdXJjZXMiOlsiY29mZmVlXFxnbG9iYWxzLmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsSUFBQSxDQUFBLEVBQUEsQ0FBQSxFQUFBLElBQUEsRUFBQSxPQUFBLEVBQUEsSUFBQTtFQUFBOzs7QUFBQSxPQUFBO0VBQVEsR0FBUjtFQUFZLEdBQVo7RUFBZ0IsS0FBaEI7RUFBc0IsS0FBdEI7RUFBNEIsS0FBNUI7RUFBa0MsV0FBbEM7RUFBOEMsU0FBOUM7Q0FBQSxNQUFBOztBQUNBLE9BQUE7RUFBUSxNQUFSO0NBQUEsTUFBQTs7QUFDQSxPQUFPLENBQVAsTUFBQTs7QUFDQSxPQUFPLFFBQVAsTUFBQTs7QUFDQSxPQUFBO0VBQVEsUUFBUjtDQUFBLE1BQUEsb0JBSkE7OztBQVFBLE9BQUEsSUFBTyxNQUFBLEdBQVMsQ0FBQTs7RUFHZixJQUFBLEVBQU8sTUFIUTtFQUlmLEdBQUEsRUFBTSxFQUpTO0VBTWYsT0FBQSxFQUFRLFFBTk87RUFPZixLQUFBLEVBQU0sSUFQUztFQVFmLEtBQUEsRUFBTSxDQVJTO0VBU2YsUUFBQSxFQUFVLEVBVEs7RUFVZixJQUFBLEVBQUssRUFWVTtFQVdmLElBQUEsRUFBSyxDQUFBLENBWFU7RUFZZixJQUFBLEVBQUssSUFaVTtFQWFmLE9BQUEsRUFBUSxFQWJPO0VBY2YsUUFBQSxFQUFVLENBQUEsQ0FkSztFQWVmLFFBQUEsRUFBUyxDQWZNO0VBZ0JmLFFBQUEsRUFBUyxJQWhCTTtFQWlCZixLQUFBLEVBQU8sQ0FqQlE7RUFrQmYsS0FBQSxFQUFNLEVBbEJTO0FBQUE7O0FBcUJoQixPQUFBLElBQU8sTUFBQSxHQUFTLENBQUMsR0FBRCxDQUFBLEdBQUE7QUFDaEIsTUFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQTtFQUFDLEtBQUssQ0FBQyxNQUFOLENBQWEsR0FBYjtFQUNBLEVBQUEsR0FBSyxVQUFVLENBQUMsT0FBWCxDQUFtQixHQUFHLENB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O0lBQ2pDLE9BQU8sQ0FBQyxHQUFSLENBQVksTUFBWixFQUFtQixDQUFDLEtBQUQsRUFBTyxHQUFQLEVBQVcsR0FBWCxDQUFuQjtJQUNBLE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBYixDQUFrQixHQUFsQjtJQUNBLE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBYixDQUFrQixNQUFNLENBQUMsUUFBekI7SUFDQSxNQUFNLENBQUMsUUFBUCxHQUFrQixNQUFNLENBQUMsUUFBUSxDQUFDLEdBQUQ7V0FDakMsWUFBQSxDQUFBLEVBUEk7R0FBQSxNQVFBLElBQUcsR0FBQSxLQUFPLE1BQVY7V0FBc0IsUUFBQSxDQUFTLE1BQU0sQ0FBQyxJQUFoQixFQUFzQixNQUFNLENBQUMsSUFBUCxHQUFjLE9BQXBDLEVBQXRCO0dBQUEsTUFBQTtXQUNBLE9BQU8sQ0FBQyxHQUFSLENBQVksNEJBQVosRUFBeUMsR0FBekMsRUFEQTs7QUFoQmUiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge2Fzcyxsb2cscmFuZ2Usc3BsaXQscGFyYW0saGV4VG9CYXNlNjQsc3BhY2VTaGlwfSBmcm9tICcuLi9qcy91dGlscy5qcydcclxuaW1wb3J0IHtCdXR0b259IGZyb20gJy4uL2pzL2J1dHRvbi5qcydcclxuaW1wb3J0IF8gZnJvbSAnaHR0cHM6Ly9jZG4uc2t5cGFjay5kZXYvbG9kYXNoJ1xyXG5pbXBvcnQgY3J5cHRvSnMgZnJvbSAnaHR0cHM6Ly9jZG4uc2t5cGFjay5kZXYvY3J5cHRvLWpzJ1xyXG5pbXBvcnQge2Rvd25sb2FkfSBmcm9tICcuLi9qcy9kb3dubG9hZC5qcydcclxuXHJcbiMgZXhwb3J0IHJlYWRBcnIgPSAoZmlsZW5hbWUpID0+IGdsb2JhbC5hcnIgPSAobG9hZEpTT04gZmlsZW5hbWUpLmFyclxyXG5cclxuZXhwb3J0IGdsb2JhbCA9IHtcclxuXHJcblx0I25hbWUgOiAnYmlzaG9wJyxcclxuXHRuYW1lIDogJ3RyZWUnLFxyXG5cdGFyciA6IFtdLFxyXG5cclxuXHR2ZXJzaW9uOid2ZXI6IEInLFxyXG5cdGJvYXJkOm51bGwsXHJcblx0Y2hpbGQ6MCwgIyBtb3ZlIHVuZGVyIGNvbnNpZGVyYXRpb25cclxuXHRjaGlsZHJlbjogW10sICMgc29ydGVkIGxpc3Qgb2YgW3ZhbHVlLHNhbix1Y2ldXHJcblx0U0laRTo1MCwgIyBvZiBzcXVhcmVcclxuXHRwaWNzOnt9LCAjIDEyIHBqw6RzZXJcclxuXHRkYXRhOm51bGwsXHJcblx0YnV0dG9uczpbXSxcclxuXHRkYXRhYmFzZToge30sICMgZmVuID0+IHZhbHVlXHJcblx0Y3VyclRyZWU6MCwgIyBpbmRleCB0aWxsIHRyw6RkZW5cclxuXHRjdXJyTm9kZTpudWxsLCAjIHBla2FyIGluIGkgZXR0IHRyw6RkXHJcblx0Y291bnQ6IDAsICMgcsOka25hciBhbnRhbCBueWEgZHJhZyBpIHRyw6RkZXRcclxuXHRzdGFjazpbXSAjIGlubmVow6VsbGVyIGFrdHVlbGwgZ3JlblxyXG59XHJcblxyXG5leHBvcnQgY29vcmRzID0gKHVjaSkgPT5cclxuXHRwYXJhbS5TdHJpbmcgdWNpXHJcblx0YzAgPSBcImFiY2RlZmdoXCIuaW5kZXhPZiB1Y2lbMF1cclxuXHRyMCA9IFwiMTIzNDU2NzhcIi5pbmRleE9mIHVjaVsxXVxyXG5cdGMxID0gXCJhYmNkZWZnaFwiLmluZGV4T2YgdWNpWzJdXHJcblx0cjEgPSBcIjEyMzQ1Njc4XCIuaW5kZXhPZiB1Y2lbM11cclxuXHRwYXJhbS5BcnJheSBbYzArOCpyMCwgYzErOCpyMV1cclxuYXNzIFs4LDI0XSwgY29vcmRzIFwiYTJhNFwiXHJcblxyXG5leHBvcnQgdG9VQ0kgPSAoW2Zyb20sdG9dKSA9PlxyXG5cdHBhcmFtLkludGVnZXIgZnJvbVxyXG5cdHBhcmFtLkludGVnZXIgdG9cclxuXHRjMCA9IFwiYWJjZGVmZ2hcIltmcm9tJThdXHJcblx0cjAgPSBcIjEyMzQ1Njc4XCJbZnJvbS8vOF1cclxuXHRjMSA9IFwiYWJjZGVmZ2hcIlt0byU4XVxyXG5cdHIxID0gXCIxMjM0NTY3OFwiW3RvLy84XVxyXG5cdHBhcmFtLlN0cmluZyBjMCtyMCtjMStyMVxyXG5hc3MgXCJlMmU0XCIsIHRvVUNJIFsxMiwyOF1cclxuXHJcbmV4cG9ydCB0b09iamVjdE5vdGF0aW9uID0gKFtmcm9tLHRvXSkgPT5cclxuXHRwYXJhbS5JbnRlZ2VyIGZyb21cclxuXHRwYXJhbS5JbnRlZ2VyIHRvXHJcblx0dWNpID0gdG9VQ0kgW2Zyb20sdG9dXHJcblx0ZnJvbSA9IHVjaS5zbGljZSAwLDJcclxuXHR0byA9IHVjaS5zbGljZSAyLDRcclxuXHRwYXJhbS5PYmplY3Qge2Zyb20sIHRvfVxyXG5hc3Mge2Zyb206J2UyJywgdG86J2U0J30sIHRvT2JqZWN0Tm90YXRpb24gWzEyLDI4XVxyXG5cclxuZXhwb3J0IGVtcHR5ID0gKG4pID0+XHJcblx0cGFyYW0uSW50ZWdlciBuXHJcblx0cGFyYW0uU3RyaW5nICgxK24vLzgpLnRvU3RyaW5nKClcclxuXHJcbnVuZG8gPSA9PiBcclxuXHRpZiBnbG9iYWwuc3RhY2subGVuZ3RoID09IDAgdGhlbiByZXR1cm5cclxuXHRnbG9iYWwuY2hlc3MudW5kbygpXHJcblx0Z2xvYmFsLmN1cnJOb2RlID0gZ2xvYmFsLnN0YWNrLnBvcCgpXHJcblx0bWFrZUNoaWxkcmVuKClcclxuXHJcbmV4cG9ydCBkdW1wU3RhdGUgPSA9PlxyXG5cdGNvbnNvbGUubG9nICdTVEFURSAjIyMjIyMjIydcclxuXHRjb25zb2xlLmxvZyAnICBzdGFjaycsZ2xvYmFsLnN0YWNrXHJcblx0Y29uc29sZS5sb2cgJyAgY3Vyck5vZGUnLGdsb2JhbC5jdXJyTm9kZVxyXG5cdGNvbnNvbGUubG9nICcgIGhpc3RvcnknLGdsb2JhbC5jaGVzcy5oaXN0b3J5KClcclxuXHJcbmV4cG9ydCBtYWtlQ2hpbGRyZW4gPSA9PlxyXG5cdGNvbnNvbGUubG9nICdtYWtlQ2hpbGRyZW4nXHJcblx0a2V5cyA9IF8ua2V5cyBnbG9iYWwuY3Vyck5vZGVcclxuXHRnbG9iYWwuY2hpbGRyZW4gPSBbXVxyXG5cdGZvciBpIGluIHJhbmdlIGtleXMubGVuZ3RoXHJcblx0XHRrZXkgPSBrZXlzW2ldXHJcblx0XHRwYWlyID0gY29vcmRzIGtleVxyXG5cdFx0Z2xvYmFsLmNoZXNzLm1vdmUgdG9PYmplY3ROb3RhdGlvbiBwYWlyXHJcblx0XHRmZW4gPSBnbG9iYWwuY2hlc3MuZmVuKClcclxuXHRcdHNhbiA9IF8ubGFzdCBnbG9iYWwuY2hlc3MuaGlzdG9yeSgpXHJcblx0XHRiYXNlNjQgPSBoZXhUb0Jhc2U2NChjcnlwdG9Kcy5TSEEyNTYoZmVuKS50b1N0cmluZygpKS5zbGljZSAwLDhcclxuXHRcdHZhbHVlID0gaWYgZ2xvYmFsLmRhdGFiYXNlW2Jhc2U2NF0gPT0gbnVsbCB0aGVuIFwiPzk5XCIgZWxzZSBnbG9iYWwuZGF0YWJhc2VbYmFzZTY0XVxyXG5cdFx0Z2xvYmFsLmNoaWxkcmVuLnB1c2ggW3ZhbHVlLHNhbixrZXldXHJcblx0XHRjb25zb2xlLmxvZyBrZXksIHNhbiwgYmFzZTY0LCB2YWx1ZSwgZmVuXHJcblx0XHRnbG9iYWwuY2hlc3MudW5kbygpXHJcblx0Z2xvYmFsLmNoaWxkcmVuID0gc29ydGVyYSBnbG9iYWwuY2hpbGRyZW5cclxuXHRpZiBnbG9iYWwuc3RhY2subGVuZ3RoJSUyPT0wIHRoZW4gZ2xvYmFsLmNoaWxkcmVuLnJldmVyc2UoKVxyXG5cdGdsb2JhbC5jaGlsZCA9IDBcclxuXHRjb25zb2xlLmxvZyAnY2hpbGRyZW4nLGdsb2JhbC5jaGlsZHJlblxyXG5cclxuc29ydGVyYSA9IChhcnIpID0+ICMgSGFudGVyYXIgZWogbWF0dGFyIGF2IG9saWthIGzDpG5nZC4gXHJcblx0IyAjMSBvY2ggIzIgZXJzw6R0dHMgYsOlZGEgbWVkIDk5OTlcclxuXHQjICMtMSBvY2ggIy0yIGVyc8OkdHRzIGLDpWRhIG1lZCAtOTk5OVxyXG5cdCMgQsO2cjogIzEgPiAjMlxyXG5cdCMgw4RyOiAjMSA9PSAjMlxyXG5cdHBhcmFtLkFycmF5IGFyclxyXG5cdGFyciA9IF8ubWFwIGFyciwgKFthLGIsY10pID0+IFxyXG5cdFx0aWYgdHlwZW9mIGE9PSdudW1iZXInIHRoZW4gcmV0dXJuIFthLGIsY11cclxuXHRcdGlmICctJyBpbiBhIHRoZW4gcmV0dXJuIFstOTk5OSxiLGNdIGVsc2UgcmV0dXJuIFs5OTk5LGIsY11cclxuXHRhcnIuc29ydCAoYSxiKSA9PiBzcGFjZVNoaXAgYVswXSxiWzBdXHJcbmFzcyBbWzIsXCJOZjNcIixcImcxZjNcIl0sWzExLFwiZTRcIixcImUyZTRcIl1dLCBzb3J0ZXJhIFtbMTEsXCJlNFwiLFwiZTJlNFwiXSxbMixcIk5mM1wiLFwiZzFmM1wiXV1cclxuYXNzIFtbLTk5OTksXCJOZjNcIixcImcxZjNcIl0sWzk5OTksXCJlNFwiLFwiZTJlNFwiXV0sIHNvcnRlcmEgW1tcIiMxXCIsXCJlNFwiLFwiZTJlNFwiXSxbXCIjLTJcIixcIk5mM1wiLFwiZzFmM1wiXV1cclxuYXNzIFtbLTk5OTksXCJOZjNcIixcImcxZjNcIl0sWzExLFwiZTRcIixcImUyZTRcIl1dLCBzb3J0ZXJhIFtbMTEsXCJlNFwiLFwiZTJlNFwiXSxbXCIjLTJcIixcIk5mM1wiLFwiZzFmM1wiXV1cclxuXHJcbmV4cG9ydCBsb2FkVHJlZSA9IChkZWx0YSkgPT5cclxuXHRwYXJhbS5UZXN0IGRlbHRhIGluIFstMSwwLDFdXHJcblx0Z2xvYmFsLmN1cnJUcmVlID0gKGdsb2JhbC5jdXJyVHJlZStkZWx0YSkgJSUgXy5zaXplIGdsb2JhbC50cmVlc1xyXG5cdGdsb2JhbC5jdXJyTm9kZSA9IGdsb2JhbC50cmVlICMubW92ZXNbXCJcIl1cclxuXHRnbG9iYWwuc3RhY2sgPSBbXVxyXG5cdG1ha2VDaGlsZHJlbigpXHJcblxyXG5nID0gKGl0ZW0pID0+XHJcblx0IyBwYXJhbS5JbnRlZ2VyIGl0ZW0gb3IgcGFyYW0uU3RyaW5nXHJcblx0aWYgXCIjLVwiIGluIGl0ZW0gdGhlbiByZXR1cm4gLTEwMDBcclxuXHRpZiBcIiNcIiBpbiBpdGVtIHRoZW4gcmV0dXJuIDEwMDBcclxuXHRwYXJhbS5JbnRlZ2VyIHBhcnNlSW50IGl0ZW1cclxuXHJcbmYgPSAoYXJyU2NvcmUsYykgPT5cclxuXHRwYXJhbS5BcnJheSBhcnJTY29yZVxyXG5cdHBhcmFtLlN0cmluZyBjXHJcblx0YXJyU2NvcmUgPSBfLm1hcCBhcnJTY29yZSwgKGl0ZW0pID0+IGcgaXRlbVxyXG5cdGEgPSBfLm1pbiBhcnJTY29yZVxyXG5cdGIgPSBfLm1heCBhcnJTY29yZVxyXG5cdGMgPSBnIGNcclxuXHRkID0gXy5tYXggW01hdGguYWJzKGEpLE1hdGguYWJzKGIpXVxyXG5cdGEgPSAtZFxyXG5cdHBhcmFtLk51bWJlciAoYy1hKS8oMipkKVxyXG5hc3MgMCwgZiBbLTEwMCw1MF0sJy0xMDAnXHJcbmFzcyAwLjc1LCBmIFstMTAwLDUwXSwnNTAnXHJcbmFzcyAxLCBmIFstMTAwLDUwXSwnMTAwJ1xyXG5cclxubGluayA9ID0+ICdodHRwczovL2xpY2hlc3Mub3JnL2FuYWx5c2lzLycgKyBnbG9iYWwuY2hlc3MuZmVuKClcclxuXHJcbmV4cG9ydCBjbGlja1N0cmluZyA9IChrZXkpID0+XHJcblx0cGFyYW0uU3RyaW5nIGtleVxyXG5cdGlmIGtleSA9PSAnZmxpcCcgdGhlbiBnbG9iYWwuYm9hcmQuZmxpcCgpXHJcblx0ZWxzZSBpZiBrZXkgPT0gJ2xpbmsnIHRoZW4gd2luZG93Lm9wZW4gbGluaygpLCAnX2JsYW5rJ1xyXG5cdGVsc2UgaWYga2V5ID09ICd1cCcgICB0aGVuIGdsb2JhbC5jaGlsZCA9IChnbG9iYWwuY2hpbGQtMSkgJSUgZ2xvYmFsLmNoaWxkcmVuLmxlbmd0aFxyXG5cdGVsc2UgaWYga2V5ID09ICdkb3duJyB0aGVuIGdsb2JhbC5jaGlsZCA9IChnbG9iYWwuY2hpbGQrMSkgJSUgZ2xvYmFsLmNoaWxkcmVuLmxlbmd0aFxyXG5cdGVsc2UgaWYga2V5ID09ICd1bmRvJyB0aGVuIHVuZG8oKVxyXG5cdGVsc2UgaWYga2V5ID09ICdsZWZ0JyB0aGVuIHVuZG8oKVxyXG5cdGVsc2UgaWYga2V5ID09ICdyaWdodCdcclxuXHRcdGNvbnNvbGUubG9nIGdsb2JhbC5jaGlsZHJlbixnbG9iYWwuY2hpbGRcclxuXHRcdFt2YWx1ZSxzYW4sdWNpXSA9IGdsb2JhbC5jaGlsZHJlbltnbG9iYWwuY2hpbGRdXHJcblx0XHRjb25zb2xlLmxvZyAnbW92ZScsW3ZhbHVlLHNhbix1Y2ldXHJcblx0XHRnbG9iYWwuY2hlc3MubW92ZSBzYW5cclxuXHRcdGdsb2JhbC5zdGFjay5wdXNoIGdsb2JhbC5jdXJyTm9kZVxyXG5cdFx0Z2xvYmFsLmN1cnJOb2RlID0gZ2xvYmFsLmN1cnJOb2RlW3VjaV1cclxuXHRcdG1ha2VDaGlsZHJlbigpXHJcblx0ZWxzZSBpZiBrZXkgPT0gJ3NhdmUnIHRoZW4gZG93bmxvYWQgZ2xvYmFsLnRyZWUsIGdsb2JhbC5uYW1lICsgJy5qc29uJ1xyXG5cdGVsc2UgY29uc29sZS5sb2cgJ3Vua25vd24ga2V5IGluIGNsaWNrU3RyaW5nJyxrZXlcclxuIl19
//# sourceURL=c:\github\2023-022-ChessOpenings-SpacedRepetition\coffee\globals.coffee